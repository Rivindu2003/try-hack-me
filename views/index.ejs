<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Rivindu's Vulnerable Lab</title>
  <link rel="stylesheet" href="/public/styles.css">
</head>
<body class="ivl-body">
  <a class="ivl-skip-link" href="#ivl-main">Skip to main content</a>
  <div class="ivl-shell">
    <header class="ivl-header">
      <div class="ivl-header-inner">
        <a class="ivl-brand" href="/">
          <img src="/public/assets/logo.svg" alt="Rivindu's Vulnerable Lab logo">
          <span>Rivindu's Vulnerable Lab</span>
        </a>

        <!-- Flag is somewhere instructions meant for automated site crawlers -->

        <nav class="ivl-nav" aria-label="Primary">
          <ul class="ivl-nav-list">
            <li><a class="ivl-nav-link" href="/">Home</a></li>
            <li><a class="ivl-nav-link" href="/login">Login</a></li>
            <li><a class="ivl-nav-link" href="/comments">Comments</a></li>
            <li><a class="ivl-nav-link" href="/orders/1">Orders</a></li>
            <li><a class="ivl-nav-link" href="/upload">Upload</a></li>
          </ul>
          <button type="button" class="ivl-theme-toggle" data-ivl-theme-toggle aria-pressed="false">
            <span class="ivl-theme-toggle__icon" data-ivl-theme-icon><img src="/public/assets/icon-moon.svg" alt="" aria-hidden="true"></span>
            <span class="ivl-theme-toggle__label" data-ivl-theme-label>Dark mode</span>
          </button>
        </nav>
      </div>
    </header>
    <main class="ivl-main" id="ivl-main">
      <section class="ivl-card ivl-card--accent ivl-hero" aria-labelledby="ivl-home-title">
        <h1 class="ivl-heading-xl" id="ivl-home-title">Welcome to the Rivindu's Vulnerable Lab Env</h1>
        <p class="ivl-muted">Hands-on practice for spotting and exploiting common web vulnerabilities. Hosted locally for training only.</p>
      </section>

      <section class="ivl-section">
        <div class="ivl-grid">
          <article class="ivl-card ivl-stack" aria-labelledby="ivl-account-status">
            <div>
              <h2 class="ivl-heading-lg" id="ivl-account-status">Session status</h2>
              <% if (user) { %>
                <p>You are signed in as <strong><%= user.username %></strong> (<%= user.role %>). <a href="/logout">Log out</a></p>
                <% if (secretNote) { %>
                  <div class="ivl-status ivl-status--success" role="status">Secret note: <code class="ivl-mono"><%= secretNote %></code></div>
                <% } else { %>
                  <p class="ivl-muted">No secret note is stored for this account.</p>
                <% } %>
              <% } else { %>
                <p class="ivl-muted">You are not authenticated. Head to the login page to begin.</p>
              <% } %>
            </div>
          </article>

          <article class="ivl-card ivl-stack" aria-labelledby="ivl-vulns">
            <h2 class="ivl-heading-lg" id="ivl-vulns">Challenge checklist</h2>
            <p>Each touchpoint below is intentionally unsafe. Use it to practice finding and chaining issues; do not patch them in this branch.</p>
            <ul class="ivl-stack">
              <li>
                <strong>SQL injection:</strong> The login form uses raw string concatenation so crafted credentials unlock other accounts.
              </li>
              <li>
                <strong>IDOR:</strong> Orders lack ownership checks, so try cycling IDs.
              </li>
              <li>
                <strong>Stored XSS:</strong> Post HTML in comments and review as an admin.
              </li>
              <li>
                <strong>Insecure upload:</strong> Push `.js` payloads, then execute via `/uploads/exec`.
              </li>
            </ul>
          </article>
        </div>
      </section>

      <section class="ivl-section" aria-labelledby="ivl-flags">
        <div class="ivl-card ivl-stack ivl-surface-cta">
          <h2 class="ivl-heading-lg" id="ivl-flags">Flag tracker</h2>
          <p>The training database seeds several capture points. Track your progress with the quick-reference list below or open the dedicated <a href="/flags">flags page</a>.</p>
          <div class="ivl-flag-grid" role="list">
            <div class="ivl-flag-card" role="listitem">
              <h3 class="ivl-heading-md">Public</h3>
              <p class="ivl-muted">flag_easy.txt</p>
            </div>
            <div class="ivl-flag-card" role="listitem">
              <h3 class="ivl-heading-md">SQLi</h3>
              <p class="ivl-muted">`users.secret_note`</p>
            </div>
            <div class="ivl-flag-card" role="listitem">
              <h3 class="ivl-heading-md">IDOR</h3>
              <p class="ivl-muted">Order #2 description</p>
            </div>
            <div class="ivl-flag-card" role="listitem">
              <h3 class="ivl-heading-md">Admin XSS</h3>
              <p class="ivl-muted">`/admin/messages` DOM</p>
            </div>
          </div>
        </div>
      </section>
    </main>
    <footer class="ivl-footer">Built for local training labs. Deliberately exploitable; handle with care.</footer>
  </div>
  <script src="/public/app.js" defer></script>
</body>
</html>
